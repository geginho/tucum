if(typeof convertHex!="function"){function convertHex(e,t){t=t==""?75:t;var r,f,i;e=e.replace("#","");t=t>1?t/100:t;r=parseInt(e.substring(0,2),16);f=parseInt(e.substring(2,4),16);i=parseInt(e.substring(4,6),16);return"rgba("+r+","+f+","+i+","+t+")"}}jQuery(document).ready(function(e){"use strict";function t(t,r){e.post(rfbwp_ajax,{action:"rfbwp_get_flipbook",rfbwp_id:t},function(e){r.append(e).find("li.fullscreen").remove();r.siblings(".rfbwp-close").addClass("rfbwp-show");d.trigger("rfbwp.shelf");setTimeout(function(){l.removeClass("rfbwp-animate rfbwp-swap");l.fadeOut(200);v=false;u=r.find(".flipbook");r.parent().css("overflow","hidden");setTimeout(function(){r.parent().css("overflow","")},250)},250)})}function r(t){var r=0,f=t.data.shelf.width()-t.data.books.length*20,i=200;t.data.books.each(function(){r+=parseFloat(e(this).attr("data-fb-r"))});i=i<Math.floor(f/r)?i:Math.floor(f/r);t.data.books.each(function(){var t=e(this);t.css({width:Math.floor(i*t.attr("data-fb-r")),height:i})});t.data.shelf.addClass("rfbwp-wrapped")}function f(e,t){l.css({top:e.offset().top-d.scrollTop(),left:e.offset().left,width:e.outerWidth(),height:e.outerHeight()});t.append(l);o()}function i(e){l.show();l.addClass("rfbwp-animate");l.css({top:e.offset().top-d.scrollTop(),left:e.offset().left,width:e.outerWidth(),height:e.outerHeight()});setTimeout(function(){l.remove()},250)}function o(){if(typeof b=="undefined")return;var e=d.width(),t=d.height(),r=parseInt(b.attr("data-fb-p")),f=parseInt(b.attr("data-fb-w"))*2+r*2,i=parseInt(b.attr("data-fb-h"))+r*2,o=b.is(".rfbwp-hard-cover"),n=b.is(".rfbwp-nav-top"),s=b.is(".rfbwp-nav-aside"),a=parseInt(b.attr("data-fb-n")),p,w,u;if(s&&!c)a=0;w=e-20-(o?20:0);u=t-60-a-(o?20:0)+(!s&&o?10:0);if(f>w){p=w/f;f=w>>0;i=i*p>>0}if(h){f*=2;i*=2}if(i>u){p=f/i;i=u>>0;f=u*p>>0}if(f%2==1)f-=1;if(o){f+=20;i+=20}l.addClass("rfbwp-animate");l.css({top:(u-i)/2+30+(o&&!s?10:0)+(n?a:0),left:(w-f/2)/2+10+(o?15:0),width:f/2,height:i})}function n(){if(u!=undefined)o()}function s(){clearTimeout(w);w=setTimeout(function(){d.trigger("rfbwp.smart_resize")},100)}var a=e(".rfbwp-shelf");if(!a.length)return;var d=e(window),p=e("html, body"),l,c=d.width()<=768,w,b,u,h,v;d.on("resize",s);a.each(function(){var o=e(this),s=o.find(".rfbwp-shelf-book"),a=o.find(".rfbwp-shelf-cache"),w=o.find(".rfbwp-shelf-box"),g=w.find(".rfbwp-close"),m=w.find(".rfbwp-shelf-wrap");o.prev(".rfbwp-shelf").addClass("rfbwp-stack");o.on("click",".rfbwp-shelf-book",function(r){r.preventDefault();var i=e(this),n=i.attr("data-fb-id"),s=i.attr("data-fb-fs").split("|");if(v)return;v=true;b=i;h=!!(m.width()*.5*1.25<parseInt(i.attr("data-fb-w"))&&m.width()<600);p.css("overflow","hidden");l=e('<div class="rfbwp-scale"><div class="rfbwp-loader"><div class="rfbwp-circle-one"></div><div class="rfbwp-circle-two"></div></div><img src="'+i.find("img")[0].src+'"></div>');l.attr("style",i.attr("style"));if(i.is(".rfbwp-hard-cover"))l.addClass("rfbwp-hard-cover");if(e.isArray(s)){w.css({background:convertHex(s[0],s[1])});w.find(".rfbwp-close").attr("data-reverse",s[2])}else{w.removeAttr("style");w.find(".rfbwp-close").removeAttr("data-reverse")}w.addClass("rfbwp-active");f(b,o,m);setTimeout(function(){var e=a.find('.flipbook[data-fb-id="'+n+'"]').parent();if(e.length){e.appendTo(m);d.trigger("rfbwp.resize");v=false;u=e;setTimeout(function(){e.addClass("rfbwp-inited");l.fadeOut(200);g.addClass("rfbwp-show");w.css("overflow","hidden");setTimeout(function(){w.css("overflow","")},250)},250)}else{l.addClass("rfbwp-swap");t(n,m)}},250)});w.on("touchmove",function(e){e.preventDefault()});g.on("mousedown",function(e){e.preventDefault()});g.on("click",function(e){e.preventDefault();if(m.find(".flipbook").length){if(m.find("div.show-all").length){m.find("div.fb-nav").find(".show-all-close").trigger("click")}else if(m.find("div.zoomed").length){d.trigger("closeZoom")}else{if(v)return;v=true;p.css("overflow","");m.find(".flipbook").trigger("rfbwp.close");g.removeClass("rfbwp-show")}}});d.on("rfbwp.closed",function(){if(b==undefined)return;if(b.parents(".rfbwp-shelf")[0]!=o[0])return;w.removeClass("rfbwp-active");i(b);b=undefined;u=undefined;m.find(".flipbook").parent().appendTo(a);setTimeout(function(){v=false},250)});d.on("rfbwp.smart_resize",function(){c=d.width()<=768;n()});r({data:{shelf:o,books:s}});d.on("rfbwp.smart_resize",{shelf:o,books:s},r)})});jQuery(document).ready(function(e){"use strict";function t(t,r){e.post(rfbwp_ajax,{action:"rfbwp_get_flipbook",rfbwp_id:t},function(e){l.remove();r.append(e);r.siblings(".rfbwp-close").addClass("rfbwp-show");i.trigger("rfbwp.shelf");setTimeout(function(){h=false},250)})}function r(){clearTimeout(w);w=setTimeout(function(){i.trigger("rfbwp.smart_resize")},100)}var f=e(".rfbwp-popup-book");if(!f.length)return;var i=e(window),o=e("html, body"),n=e(".rfbwp-popup"),s=n.find(".rfbwp-popup-cache"),a=n.find(".rfbwp-popup-box"),d=a.find(".rfbwp-close"),p=a.find(".rfbwp-popup-wrap"),l=e('<div class="rfbwp-loader"><div class="rfbwp-circle-one"></div><div class="rfbwp-circle-two"></div></div>'),c=i.width()<=768,w,b,u,h;i.on("resize",r);f.on("click",function(r){r.preventDefault();var f=e(this),n=f.attr("data-fb-id"),c=f.attr("data-fb-fs").split("|");if(h)return;h=true;b=f;u=!!(p.width()*.5*1.25<parseInt(f.attr("data-fb-w"))&&p.width()<600);o.css("overflow","hidden");if(e.isArray(c)){a.css({background:convertHex(c[0],c[1])});a.find(".rfbwp-close").attr("data-reverse",c[2])}else{a.removeAttr("style");a.find(".rfbwp-close").removeAttr("data-reverse")}a.addClass("rfbwp-active");setTimeout(function(){var e=s.find('.flipbook[data-fb-id="'+n+'"]').parent();if(e.length){e.appendTo(p);i.trigger("rfbwp.resize");h=false;setTimeout(function(){e.addClass("rfbwp-inited");d.addClass("rfbwp-show")},250)}else{p.append(l);t(n,p)}},250)});a.on("touchmove",function(e){e.preventDefault()});d.on("mousedown",function(e){e.preventDefault()});d.on("click",function(e){e.preventDefault();if(p.find(".flipbook").length){if(p.find("div.show-all").length){p.find("div.fb-nav").find(".show-all-close").trigger("click")}else if(p.find("div.zoomed").length){i.trigger("closeZoom")}else{if(h)return;h=true;o.css("overflow","");p.find(".flipbook").trigger("rfbwp.close");d.removeClass("rfbwp-show")}}});i.on("rfbwp.closed",function(){if(b==undefined)return;a.removeClass("rfbwp-active");b=undefined;p.find(".flipbook").parent().appendTo(s);setTimeout(function(){h=false},250)});i.on("rfbwp.popup",function(){f=e(".rfbwp-popup-book")});i.on("rfbwp.smart_resize",function(){c=i.width()<=768})});